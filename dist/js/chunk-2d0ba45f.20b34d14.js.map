{"version":3,"sources":["webpack:///./src/views/ProvMuniCoordPredict.vue?226c","webpack:///./src/components/SelectForm/ProvMuniPredictSelectForm.vue?3d68","webpack:///src/components/SelectForm/ProvMuniPredictSelectForm.vue","webpack:///./src/components/SelectForm/ProvMuniPredictSelectForm.vue?e803","webpack:///./src/components/SelectForm/ProvMuniPredictSelectForm.vue","webpack:///src/views/ProvMuniCoordPredict.vue","webpack:///./src/views/ProvMuniCoordPredict.vue?f94e","webpack:///./src/views/ProvMuniCoordPredict.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","tableThreeData","tableFourData","on","$event","directives","name","rawName","value","undefined","currentChart","expression","staticStyle","exportImage","_v","displayTableData","length","exportResultSheet","staticRenderFns","ref","onSelectionChanges","slot","_s","provFileName","_e","canCommitQuery","performPrediction","data","enabledUploadButton","rawFile","knownTags","knownUploadFiles","tableThreeDataInternal","tableFourDataInternal","methods","$data","file","raw","assigns","append","$axios","post","then","computed","props","watch","$emit","component","base64ToBlob","code","uInt8Array","i","charCodeAt","Blob","generateTable","rawData","values","forEach","series","slice","year","region","payload","list","regionIndex","refreshChart","echarts","pieData","push","elem","setOption","exportTableSheet","fields","components","handler","deep","immediate"],"mappings":"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","file":"js/chunk-2d0ba45f.20b34d14.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-row',[_c('el-col',{attrs:{\"span\":7,\"offset\":1}},[_c('ProvMuniPredictSelectForm',{attrs:{\"table-three-data\":_vm.tableThreeData,\"table-four-data\":_vm.tableFourData},on:{\"update:tableThreeData\":function($event){_vm.tableThreeData=$event},\"update:table-three-data\":function($event){_vm.tableThreeData=$event},\"update:tableFourData\":function($event){_vm.tableFourData=$event},\"update:table-four-data\":function($event){_vm.tableFourData=$event}}})],1),_c('el-col',{attrs:{\"span\":15,\"offset\":1}},[_c('el-form',[_c('el-form-item',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.currentChart !== undefined),expression:\"currentChart !== undefined\"}]},[_c('el-row',[_c('div',{staticStyle:{\"width\":\"680px\",\"height\":\"300px\"},attrs:{\"id\":\"pieChart\"}})])],1),_c('el-form-item',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.currentChart !== undefined),expression:\"currentChart !== undefined\"}]},[_c('el-button',{on:{\"click\":_vm.exportImage}},[_vm._v(\"导出图像\")]),_c('el-button',{attrs:{\"disabled\":_vm.displayTableData.length === 0},on:{\"click\":_vm.exportResultSheet}},[_vm._v(\"导出预测结果表\")])],1),_c('el-form-item',{attrs:{\"label\":\"预测年份的协调预测结果：\"}},[_c('el-table',{attrs:{\"data\":_vm.displayTableData}},[_c('el-table-column',{attrs:{\"label\":\"年份\",\"prop\":\"year\"}}),_c('el-table-column',{attrs:{\"label\":\"地区\",\"prop\":\"region\"}}),_c('el-table-column',{attrs:{\"label\":\"预测值（单位：MW）\",\"prop\":\"payload\"}})],1)],1),_c('el-form-item')],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-form',{attrs:{\"label-position\":\"right\",\"label-width\":\"auto\"}},[_c('el-form-item',{attrs:{\"label\":\"数据文件：\"}},[_c('el-upload',{ref:\"upload\",attrs:{\"action\":\"/\",\"on-change\":_vm.onSelectionChanges,\"auto-upload\":false,\"multiple\":false,\"list-type\":\"text\",\"show-file-list\":false}},[_c('el-button',{attrs:{\"slot\":\"trigger\",\"size\":\"small\",\"type\":\"primary\"},slot:\"trigger\"},[_vm._v(\"选择文件\")]),(_vm.provFileName)?_c('div',[_vm._v(\" \"+_vm._s(_vm.provFileName)+\" \")]):_vm._e()],1)],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"disabled\":!_vm.canCommitQuery},on:{\"click\":_vm.performPrediction}},[_vm._v(\"预测\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <el-form label-position=\"right\" label-width=\"auto\">\n    <el-form-item label=\"数据文件：\">\n      <el-upload ref=\"upload\"\n                 action=\"/\"\n                 :on-change=\"onSelectionChanges\"\n                 :auto-upload=\"false\" :multiple=\"false\"\n                 list-type=\"text\"\n                 :show-file-list=\"false\">\n        <el-button slot=\"trigger\" size=\"small\" type=\"primary\">选择文件</el-button>\n        <div v-if=\"provFileName\"> {{ provFileName }} </div>\n      </el-upload>\n    </el-form-item>\n    <el-form-item>\n      <el-button type=\"primary\" :disabled=\"!canCommitQuery\"\n                 @click=\"performPrediction\">预测</el-button>\n    </el-form-item>\n  </el-form>\n</template>\n\n<script>\n\nexport default {\n  name: 'ProvMuniPredictSelectForm',\n  data() {\n    return {\n      enabledUploadButton: true,\n      provFileName: '',\n      rawFile: null,\n      knownTags: [],\n      knownUploadFiles: [],\n      tableThreeDataInternal: [],\n      tableFourDataInternal: [],\n    };\n  },\n  methods: {\n    onSelectionChanges(file) {\n      this.$data.provFileName = file.name;\n      this.$data.rawFile = file.raw;\n    },\n    performPrediction() {\n      const assigns = new FormData();\n      assigns.append('file', this.rawFile);\n      assigns.append('method', '省市总分协调算法');\n      this.$axios.post('/predict/provmuni', assigns).then((response) => {\n        this.$data.tableThreeDataInternal = response.data.data;\n      });\n    },\n  },\n  computed: {\n    canCommitQuery() {\n      return this.$data.provFileName.length !== 0;\n    },\n  },\n  props: [\n    'tableThreeData',\n    'tableFourData',\n  ],\n  watch: {\n    tableThreeDataInternal(value) {\n      this.$emit('update:tableThreeData', value);\n    },\n    tableFourDataInternal(value) {\n      this.$emit('update:tableFourData', value);\n    },\n  },\n};\n</script>\n\n<style scoped>\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProvMuniPredictSelectForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProvMuniPredictSelectForm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ProvMuniPredictSelectForm.vue?vue&type=template&id=4c973914&scoped=true&\"\nimport script from \"./ProvMuniPredictSelectForm.vue?vue&type=script&lang=js&\"\nexport * from \"./ProvMuniPredictSelectForm.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4c973914\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div>\n    <el-row>\n      <el-col :span=\"7\" :offset=\"1\">\n        <ProvMuniPredictSelectForm\n        :table-three-data.sync=\"tableThreeData\"\n        :table-four-data.sync=\"tableFourData\">\n        </ProvMuniPredictSelectForm>\n      </el-col>\n      <el-col :span=\"15\" :offset=\"1\">\n        <el-form>\n          <el-form-item v-show=\"currentChart !== undefined\">\n            <el-row>\n              <div id=\"pieChart\" style=\"width: 680px;height: 300px\"></div>\n            </el-row>\n          </el-form-item>\n          <el-form-item v-show=\"currentChart !== undefined\">\n            <el-button v-on:click=\"exportImage\">导出图像</el-button>\n            <el-button @click=\"exportResultSheet\"\n                       :disabled=\"displayTableData.length === 0\">导出预测结果表</el-button>\n          </el-form-item>\n          <el-form-item label=\"预测年份的协调预测结果：\">\n            <el-table :data=\"displayTableData\">\n              <el-table-column label=\"年份\" prop=\"year\"></el-table-column>\n              <el-table-column label=\"地区\" prop=\"region\"></el-table-column>\n              <el-table-column label=\"预测值（单位：MW）\" prop=\"payload\"></el-table-column>\n            </el-table>\n          </el-form-item>\n          <el-form-item>\n\n          </el-form-item>\n        </el-form>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport ProvMuniPredictSelectForm from '@/components/SelectForm/ProvMuniPredictSelectForm.vue';\nimport * as json2csv from 'json2csv';\nimport { saveAs } from 'file-saver';\nimport * as echarts from 'echarts';\n\nfunction base64ToBlob(code) {\n  const parts = code.split(';base64,');\n  const contentType = parts[0].split(':')[1];\n  const raw = window.atob(parts[1]);\n  const rawLength = raw.length;\n\n  const uInt8Array = new Uint8Array(rawLength);\n\n  // eslint-disable-next-line no-plusplus\n  for (let i = 0; i < rawLength; ++i) {\n    uInt8Array[i] = raw.charCodeAt(i);\n  }\n  return new Blob([uInt8Array], { type: contentType });\n}\n\nexport default {\n  name: 'ProvMuniCoordPredict',\n  data() {\n    return {\n      currentChart: undefined,\n      tableThreeData: [],\n      tableFourData: [],\n      displayTableData: [],\n    };\n  },\n  methods: {\n    generateTable() {\n      this.$data.displayTableData = [];\n      const rawData = this.$data.tableThreeData;\n      rawData.values.forEach((list) => {\n        let regionIndex = 1;\n        const year = list[0];\n        rawData.series.slice(1).forEach((region) => {\n          this.$data.displayTableData.push({\n            year,\n            region,\n            payload: list[regionIndex],\n          });\n          regionIndex += 1;\n        });\n      });\n    },\n    refreshChart() {\n      const data = this.$data.displayTableData;\n      if (this.currentChart === undefined) {\n        this.currentChart = echarts.init(document.getElementById('pieChart'));\n      }\n      const pieData = [];\n      data.forEach((elem) => {\n        pieData.push({\n          name: `${elem.region}, ${elem.year} 年`,\n          value: elem.payload,\n        });\n      });\n      this.currentChart.setOption({\n        series: [\n          {\n            name: '协调预测结果',\n            type: 'pie',\n            radius: '55%',\n            data: pieData,\n          },\n        ],\n      }, true);\n    },\n    exportResultSheet() {\n      this.exportTableSheet(this.$data.displayTableData, ['year', 'region', 'payload']);\n    },\n    exportImage() {\n      if (!this.currentChart) {\n        return;\n      }\n      const content = this.currentChart.getDataURL();\n      const blob = base64ToBlob(content);\n      saveAs(blob, '协调预测结果图像.png');\n    },\n    exportTableSheet(rawData, fields) {\n      const data = json2csv.parse(rawData, {\n        fields,\n      });\n      const blob = new Blob([data], { type: 'text/csv' });\n      saveAs(blob, '协调预测结果表格.csv');\n    },\n  },\n  components: { ProvMuniPredictSelectForm },\n  watch: {\n    tableThreeData: {\n      handler() {\n        this.generateTable();\n        this.refreshChart();\n      },\n      deep: true,\n      immediate: false,\n    },\n  },\n};\n</script>\n\n<style scoped>\n\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProvMuniCoordPredict.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProvMuniCoordPredict.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ProvMuniCoordPredict.vue?vue&type=template&id=2d959abc&scoped=true&\"\nimport script from \"./ProvMuniCoordPredict.vue?vue&type=script&lang=js&\"\nexport * from \"./ProvMuniCoordPredict.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2d959abc\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}