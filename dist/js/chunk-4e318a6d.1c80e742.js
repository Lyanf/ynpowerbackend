(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e318a6d"],{1148:function(e,t,a){"use strict";var r=a("a691"),n=a("1d80");e.exports="".repeat||function(e){var t=String(n(this)),a="",i=r(e);if(i<0||i==1/0)throw RangeError("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(a+=t);return a}},"408a":function(e,t,a){var r=a("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=r(e))throw TypeError("Incorrect invocation");return+e}},"7d63":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{"label-position":"right","label-width":"auto"}},[a("el-form-item",{attrs:{label:"预测方法："}},[a("el-select",{attrs:{placeholder:"请选择",disabled:null!==e.wiredMethod},model:{value:e.postParams.method,callback:function(t){e.$set(e.postParams,"method",t)},expression:"postParams.method"}},e._l(e.allMethods,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"历史年份："}},[a("year-range-selector",{attrs:{"begin-year":e.postParams.historyBeginYear,"end-year":e.postParams.historyEndYear},on:{"update:beginYear":function(t){return e.$set(e.postParams,"historyBeginYear",t)},"update:begin-year":function(t){return e.$set(e.postParams,"historyBeginYear",t)},"update:endYear":function(t){return e.$set(e.postParams,"historyEndYear",t)},"update:end-year":function(t){return e.$set(e.postParams,"historyEndYear",t)}}})],1),a("el-form-item",{attrs:{label:"预测年份："}},[a("year-range-selector",{attrs:{"begin-year":e.postParams.beginYear,"end-year":e.postParams.endYear},on:{"update:beginYear":function(t){return e.$set(e.postParams,"beginYear",t)},"update:begin-year":function(t){return e.$set(e.postParams,"beginYear",t)},"update:endYear":function(t){return e.$set(e.postParams,"endYear",t)},"update:end-year":function(t){return e.$set(e.postParams,"endYear",t)}}})],1),e._l(e.requiredParams,(function(t){return a("div",{key:t.key},[a("el-form-item",{attrs:{label:t.label+"："}},["int"===t.kind?a("el-input",{attrs:{step:1,type:"number",min:t.limits.min_value,max:t.limits.max_value,clearable:"",placeholder:"请输入整数数字"},model:{value:e.postParams[t.key],callback:function(a){e.$set(e.postParams,t.key,a)},expression:"postParams[param.key]"}}):"float"===t.kind?a("el-input",{attrs:{step:.01,type:"number",min:t.limits.min_value,max:t.limits.max_value,clearable:"",placeholder:"请输入数字"},model:{value:e.postParams[t.key],callback:function(a){e.$set(e.postParams,t.key,a)},expression:"postParams[param.key]"}}):t.kind.startsWith("option")?a("el-select",{attrs:{placeholder:"请选择一项"},model:{value:e.postParams[t.key],callback:function(a){e.$set(e.postParams,t.key,a)},expression:"postParams[param.key]"}},e._l(t.value,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1):t.kind.startsWith("multioption")?a("div",[a("el-select",{attrs:{multiple:"",placeholder:e.generateMultipleChoicePlaceholder(t.limits),"multiple-limit":t.limits.max_choice},model:{value:e.postParams[t.key],callback:function(a){e.$set(e.postParams,t.key,a)},expression:"postParams[param.key]"}},e._l(t.value,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),"要剔除的行业名单"===t.label?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{disabled:null===e.postParams.beginYear||null===e.postParams.endYear},on:{click:e.generateTemplate}},[e._v("生成模版")]):e._e()],1):"file"===t.kind?a("el-upload",{ref:"upload",refInFor:!0,attrs:{action:"/","on-change":e.getUploader(t.key,e.rawFileNames,e.rawFiles),"auto-upload":!1,multiple:!1,"list-type":"text","show-file-list":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选择文件")]),e.rawFileNames[t.key]?a("div",[e._v(" "+e._s(e.rawFileNames[t.key])+" ")]):e._e()],1):"bool"===t.kind?a("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.postParams[t.key],callback:function(a){e.$set(e.postParams,t.key,a)},expression:"postParams[param.key]"}}):a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.postParams[t.key],callback:function(a){e.$set(e.postParams,t.key,a)},expression:"postParams[param.key]"}})],1)],1)})),a("el-form-item",{attrs:{label:"方案标签："}},[a("el-input",{attrs:{clearable:"",placeholder:"可留空"},model:{value:e.postParams.tag,callback:function(t){e.$set(e.postParams,"tag",t)},expression:"postParams.tag"}})],1),a("el-form-item",{attrs:{label:"加载方案："}},[a("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:"选择标签",size:"small"},model:{value:e.currentTag,callback:function(t){e.currentTag=t},expression:"currentTag"}},e._l(e.knownTags,(function(e){return a("el-option",{key:e.tag,attrs:{label:e.tag,value:e.tag}})})),1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",disabled:null===e.currentTag},on:{click:e.loadParameters}},[e._v("加载")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",disabled:!e.canCommitQuery},on:{click:e.performPrediction}},[e._v("预测")])],1)],2)},n=[],i=(a("99af"),a("159b"),a("b0c0"),a("b64b"),a("caad"),a("2532"),a("21c9")),o=a("f59f"),l=a("21a6"),s={name:"SinglePredictSelectForm",components:{YearRangeSelector:i["a"]},data:function(){return{onlyThosePostParams:{historyBeginYear:null,historyEndYear:null,beginYear:null,endYear:null,method:"",tag:null,tagType:this.tagType},graphDataInternal:[],tableOneDataInternal:[],tableTwoDataInternal:[],requiredParams:[],rawFiles:{},rawFileNames:{},allMethods:[],postParams:{historyBeginYear:null,historyEndYear:null,beginYear:null,endYear:null,method:"",tag:null,tagType:this.tagType},knownTags:[],currentTag:null}},computed:{canCommitQuery:function(){var e=this.$data.postParams;return null!==e.beginYear&&null!==e.endYear&&(null!==e.historyBeginYear&&null!==e.historyEndYear)}},mounted:function(){this.$data.postParams.method=this.wiredMethod,this.loadTags()},methods:{generateTemplate:function(){for(var e=[],t=this.$data.postParams,a=function(a){var r={year:a};t.rejectlsit.forEach((function(e){r[e]=null})),e.push(r)},r=t.beginYear;r<=t.endYear;r+=1)a(r);console.log(e),console.log(["year"]+t.rejectlsit);var n=o["parse"](e,{fields:["year"].concat(t.rejectlsit)}),i=new Blob(["\ufeff".concat(n)],{type:"text/csv;charset=utf-8"});Object(l["saveAs"])(i,"剔除数据模版.csv")},getUploader:function(e,t,a){var r=this;return function(n){t[e]=n.name,a[e]=n.raw,r._watcher.update()}},loadTags:function(){var e=this;this.$axios.get("/tags/query",{params:{tagType:this.tagType}}).then((function(t){e.$data.knownTags=t.data.data}))},performPrediction:function(){var e=this,t=new FormData;Object.keys(this.$data.postParams).forEach((function(a){t.append(a,e.$data.postParams[a])})),t.append("StartYear",this.$data.postParams.historyBeginYear),t.append("EndYear",this.$data.postParams.historyEndYear),t.append("PreStartYear",this.$data.postParams.beginYear),t.append("PreEndYear",this.$data.postParams.endYear),Object.keys(this.$data.rawFiles).forEach((function(a){t.append(a,e.$data.rawFiles[a])})),this.$axios.post("/predict/region/single",t).then((function(t){e.$data.graphDataInternal=t.data.data.tableTwoData,e.$data.tableOneDataInternal=t.data.data.tableOneData,e.$data.tableTwoDataInternal=t.data.data.tableTwoData}))},loadParameters:function(){var e=this;this.$axios.get("/params/predict/static/region",{params:{tag:this.$data.currentTag}}).then((function(t){e.$data.postParams=t.data.data}))},generateMultipleChoicePlaceholder:function(e){return e.min_choice&&e.max_choice?e.min_choice===e.max_choice?"请选择 ".concat(e.max_choice," 项"):"请选择 ".concat(e.min_choice," 到 ").concat(e.max_choice," 项"):e.max_choice?"请选择不超过 ".concat(e.max_choice," 项"):e.min_choice?"请选择至少 ".concat(e.min_choice," 项"):"请选择至少 1 项"}},watch:{graphDataInternal:function(e){this.$emit("update:graphData",e)},tableOneDataInternal:function(e){this.$emit("update:tableOneData",e)},tableTwoDataInternal:function(e){this.$emit("update:tableTwoData",e)},"postParams.method":function(e){var t=this,a=Object.keys(this.$data.onlyThosePostParams);Object.keys(this.$data.postParams).forEach((function(e){a.includes(e)||t.$delete(t.postParams,e)})),this.$data.requiredParams=[],this.$axios.get("/get/args",{params:{method:e}}).then((function(e){e.data.data.para.forEach((function(e){"StartYear"===e.key||"EndYear"===e.key||"PreStartYear"===e.key||"PreEndYear"===e.key||(t.$data.requiredParams.push(e),void 0!==e.default&&t.$set(t.postParams,e.key,e.default))}))}))}},props:["graphData","tableOneData","tableTwoData","wiredMethod","tagType"]},c=s,u=(a("fbd4"),a("2877")),d=Object(u["a"])(c,r,n,!1,null,"4efc11d8",null);t["a"]=d.exports},b680:function(e,t,a){"use strict";var r=a("23e7"),n=a("a691"),i=a("408a"),o=a("1148"),l=a("d039"),s=1..toFixed,c=Math.floor,u=function(e,t,a){return 0===t?a:t%2===1?u(e,t-1,a*e):u(e*e,t/2,a)},d=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},p=function(e,t,a){var r=-1,n=a;while(++r<6)n+=t*e[r],e[r]=n%1e7,n=c(n/1e7)},f=function(e,t){var a=6,r=0;while(--a>=0)r+=e[a],e[a]=c(r/t),r=r%t*1e7},h=function(e){var t=6,a="";while(--t>=0)if(""!==a||0===t||0!==e[t]){var r=String(e[t]);a=""===a?r:a+o.call("0",7-r.length)+r}return a},m=s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!l((function(){s.call({})}));r({target:"Number",proto:!0,forced:m},{toFixed:function(e){var t,a,r,l,s=i(this),c=n(e),m=[0,0,0,0,0,0],y="",b="0";if(c<0||c>20)throw RangeError("Incorrect fraction digits");if(s!=s)return"NaN";if(s<=-1e21||s>=1e21)return String(s);if(s<0&&(y="-",s=-s),s>1e-21)if(t=d(s*u(2,69,1))-69,a=t<0?s*u(2,-t,1):s/u(2,t,1),a*=4503599627370496,t=52-t,t>0){p(m,0,a),r=c;while(r>=7)p(m,1e7,0),r-=7;p(m,u(10,r,1),0),r=t-1;while(r>=23)f(m,1<<23),r-=23;f(m,1<<r),p(m,1,1),f(m,2),b=h(m)}else p(m,0,a),p(m,1<<-t,0),b=h(m)+o.call("0",c);return c>0?(l=b.length,b=y+(l<=c?"0."+o.call("0",c-l)+b:b.slice(0,l-c)+"."+b.slice(l-c))):b=y+b,b}})},c3ab:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:0!==e.graphData.length||void 0!==e.graphData.yData,expression:"graphData.length !== 0 || graphData.yData !== undefined"}],staticStyle:{"margin-left":"20px"}},[a("el-row",[a("div",{staticStyle:{width:"680px",height:"300px"},attrs:{id:e.uniqueId}})]),a("el-row",[a("el-form",[a("el-form-item",[a("el-button",{on:{click:e.exportImage}},[e._v("导出图像")])],1),a("el-form-item",{attrs:{label:"显示方式："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.currentDisplayMethod,callback:function(t){e.currentDisplayMethod=t},expression:"currentDisplayMethod"}},e._l(e.displayMethods,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1)],1)},n=[],i=(a("1276"),a("ac1f"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("d3b7"),a("99af"),a("b680"),a("159b"),a("313e")),o=a("21a6");function l(e){for(var t=e.split(";base64,"),a=t[0].split(":")[1],r=window.atob(t[1]),n=r.length,i=new Uint8Array(n),o=0;o<n;++o)i[o]=r.charCodeAt(o);return new Blob([i],{type:a})}var s={data:function(){return{currentChart:void 0,graphData:[],params1st:{xTag:"xName",yTag:"yValue",xName:"",yName:""},params2nd:{xTag:"",yTag1st:"",yTag2nd:"",xName:"",yName:"",yName1st:"",yName2nd:""},displayMethods:[{label:"折线图",value:"line"},{label:"柱状图",value:"bar"},{label:"散点图",value:"scatter"}],currentDisplayMethod:"line"}},methods:{refreshChartDirty:function(){var e=this.$data.params1st;void 0===this.currentChart&&(this.currentChart=i["init"](document.getElementById(this.uniqueId)));var t=this.graphData.xData,a=this.graphData.yData[0].data,r={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(e){for(var t="",a=0;a<e.length;a+=1)if(""!==e[a].seriesName&&void 0!==e[a].value){var r=e[a].color;t+='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background:'.concat(r,'"></span>'),t+="".concat(e[a].seriesName," - ").concat(parseFloat(e[a].value).toFixed(2),"</br>")}return t}},xAxis:{type:"category",name:e.xName,data:t,axisTick:{alignWithLabel:!0},boundaryGap:"bar"===this.$data.currentDisplayMethod,onZero:!0,axisLabel:{show:!0,textStyle:{color:"#ffffff",fontSize:14}},axisLine:{lineStyle:{color:"#ffffff"}}},yAxis:{type:"value",name:e.yName,axisLabel:{show:!0,textStyle:{color:"#ffffff",fontSize:14}},axisLine:{lineStyle:{color:"#ffffff"}}},series:[{data:a,name:e.yName,type:this.$data.currentDisplayMethod}],legend:{orient:"horizontal",x:"center",y:"top",textStyle:{color:"#ffffff",fontSize:16}}};this.currentChart.setOption(r,!0)},refreshChart:function(){var e=this.$data.params1st;void 0===this.currentChart&&(this.currentChart=i["init"](document.getElementById(this.uniqueId)));var t=[],a=[];this.graphData.forEach((function(e){e.year?t.push(e.year):e.time&&t.push(e.time),void 0!==e.predict?a.push(e.predict):void 0!==e.payload&&a.push(e.payload)}));var r={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(e){for(var t="",a=0;a<e.length;a+=1)if(""!==e[a].seriesName&&void 0!==e[a].value){var r=e[a].color;t+='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background:'.concat(r,'"></span>'),t+="".concat(e[a].seriesName," - ").concat(parseFloat(e[a].value).toFixed(2),"</br>")}return t}},xAxis:{type:"category",name:e.xName,data:t,axisTick:{alignWithLabel:!0},axisLabel:{show:!0,textStyle:{color:"#ffffff",fontSize:14}},axisLine:{lineStyle:{color:"#ffffff"}},boundaryGap:"bar"===this.$data.currentDisplayMethod,onZero:!0},yAxis:{type:"value",name:e.yName,axisLabel:{show:!0,textStyle:{color:"#ffffff",fontSize:14}},axisLine:{lineStyle:{color:"#ffffff"}}},series:[{data:a,name:e.yName,type:this.$data.currentDisplayMethod}],legend:{orient:"horizontal",x:"center",y:"top",textStyle:{color:"#ffffff",fontSize:16}}};this.currentChart.setOption(r,!0)},refreshChart2nd:function(){var e=this.$data.params2nd;void 0===this.currentChart&&(this.currentChart=i["init"](document.getElementById(this.uniqueId)));var t=[],a=[],r=[];this.$data.graphData.forEach((function(n){t.push(n[e.xTag]),a.push(n[e.yTag1st]),r.push(n[e.yTag2nd])}));var n={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(e){for(var t="",a=0;a<e.length;a+=1)if(""!==e[a].seriesName&&void 0!==e[a].value){var r=e[a].color;t+='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background:'.concat(r,'"></span>'),t+="".concat(e[a].seriesName," - ").concat(parseFloat(e[a].value).toFixed(2),"</br>")}return t}},xAxis:{type:"category",name:e.xName,data:t,axisTick:{alignWithLabel:!0},boundaryGap:"bar"===this.$data.currentDisplayMethod,onZero:!0,axisLabel:{show:!0,textStyle:{color:"#ffffff",fontSize:14}},axisLine:{lineStyle:{color:"#ffffff"}}},yAxis:{type:"value",name:e.yName,axisLabel:{show:!0,textStyle:{color:"#ffffff",fontSize:14}},axisLine:{lineStyle:{color:"#ffffff"}}},series:[{data:a,name:e.yName1st,type:this.$data.currentDisplayMethod},{data:r,name:e.yName2nd,type:this.$data.currentDisplayMethod}],legend:{orient:"horizontal",x:"center",y:"top",textStyle:{color:"#ffffff",fontSize:16}}};this.currentChart.setOption(n,!0)},exportImage:function(){if(this.currentChart){var e=this.currentChart.getDataURL(),t=l(e);Object(o["saveAs"])(t,"预测图像.png")}}},watch:{currentDisplayMethod:function(){"2nd"===this.typee?this.refreshChart2nd():"dirty"===this.typee?this.refreshChartDirty():this.refreshChart()}},computed:{uniqueId:function(){return void 0!==this.uid?this.uid:"globalChart"}},props:["typee","uid","title"]},c=s,u=a("2877"),d=Object(u["a"])(c,r,n,!1,null,"b6b52bdc",null);t["a"]=d.exports},f418:function(e,t,a){},f70a:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",[void 0===e.nomapermse&&0!==e.tableOneData.length?a("el-form-item",{attrs:{label:"评价指标表："}},[a("el-table",{attrs:{data:e.tableOneData}},[a("el-table-column",{attrs:{prop:"mape",label:"MAPE（%）"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.mape.toFixed(2))+" ")]}}],null,!1,3612083124)}),a("el-table-column",{attrs:{prop:"rmse",label:"RMSE"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.rmse.toFixed(2))+" ")]}}],null,!1,616966500)})],1)],1):e._e(),void 0===e.nomapermse&&0!==e.tableOneData.length?a("el-form-item",[a("el-button",{on:{click:e.exportTableOneSheet}},[e._v("导出评价指标表")])],1):e._e(),0!==e.tableTwoData.length?a("el-form-item",{attrs:{label:"年份 − 预测值表："}},[a("el-table",{attrs:{data:e.tableTwoData}},[a("el-table-column",{attrs:{prop:"year",label:"年份"}}),a("el-table-column",{attrs:{prop:"predict",label:"预测值（MW）"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.predict.toFixed(0))+" ")]}}],null,!1,4170251218)})],1)],1):e._e(),0!==e.tableTwoData.length?a("el-form-item",[a("el-button",{on:{click:e.exportTableTwoSheet}},[e._v("导出预测结果表")])],1):e._e()],1)},n=[],i=a("f59f"),o=a("21a6"),l={name:"ResultTable",props:["nomapermse"],data:function(){return{tableOneData:[],tableTwoData:[]}},methods:{exportTableSheet:function(e,t){var a=i["parse"](e,{fields:t}),r=new Blob([a],{type:"text/csv"});Object(o["saveAs"])(r,"预测结果表.csv")},exportTableOneSheet:function(){this.exportTableSheet(this.$data.tableOneData,["mape","rmse"])},exportTableTwoSheet:function(){this.exportTableSheet(this.$data.tableTwoData,["year","predict"])}}},s=l,c=a("2877"),u=Object(c["a"])(s,r,n,!1,null,"22e16c68",null);t["a"]=u.exports},fbd4:function(e,t,a){"use strict";a("f418")}}]);
//# sourceMappingURL=chunk-4e318a6d.1c80e742.js.map