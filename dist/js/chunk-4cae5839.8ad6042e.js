(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4cae5839"],{1148:function(t,a,e){"use strict";var r=e("a691"),n=e("1d80");t.exports="".repeat||function(t){var a=String(n(this)),e="",l=r(t);if(l<0||l==1/0)throw RangeError("Wrong number of repetitions");for(;l>0;(l>>>=1)&&(a+=a))1&l&&(e+=a);return e}},"18e1":function(t,a,e){},"408a":function(t,a,e){var r=e("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=r(t))throw TypeError("Incorrect invocation");return+t}},"47ef":function(t,a,e){"use strict";var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("el-form",{attrs:{"label-position":"right","label-width":"auto"}},[e("el-form-item",{attrs:{label:"预测方法："}},[e("el-select",{attrs:{placeholder:"请选择",disabled:null!==t.wiredMethod},model:{value:t.postParams.method,callback:function(a){t.$set(t.postParams,"method",a)},expression:"postParams.method"}},t._l(t.allMethods,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"预测年份："}},[e("year-range-selector",{attrs:{"begin-year":t.postParams.beginYear,"end-year":t.postParams.endYear},on:{"update:beginYear":function(a){return t.$set(t.postParams,"beginYear",a)},"update:begin-year":function(a){return t.$set(t.postParams,"beginYear",a)},"update:endYear":function(a){return t.$set(t.postParams,"endYear",a)},"update:end-year":function(a){return t.$set(t.postParams,"endYear",a)}}})],1),t._l(t.requiredParams,(function(a){return e("div",{key:a.key},[e("el-form-item",{attrs:{label:a.label+"："}},["int"===a.kind?e("el-input",{attrs:{step:1,type:"number",min:a.limits.min_value,max:a.limits.max_value,clearable:"",placeholder:"请输入整数数字"},model:{value:t.postParams[a.key],callback:function(e){t.$set(t.postParams,a.key,e)},expression:"postParams[param.key]"}}):"float"===a.kind?e("el-input",{attrs:{step:.01,type:"number",min:a.limits.min_value,max:a.limits.max_value,clearable:"",placeholder:"请输入数字"},model:{value:t.postParams[a.key],callback:function(e){t.$set(t.postParams,a.key,e)},expression:"postParams[param.key]"}}):a.kind.startsWith("option")?e("el-select",{attrs:{placeholder:"请选择一项"},model:{value:t.postParams[a.key],callback:function(e){t.$set(t.postParams,a.key,e)},expression:"postParams[param.key]"}},t._l(a.value,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1):a.kind.startsWith("multioption")?e("el-select",{attrs:{multiple:"",placeholder:t.generateMultipleChoicePlaceholder(a.limits),"multiple-limit":a.limits.max_choice},model:{value:t.postParams[a.key],callback:function(e){t.$set(t.postParams,a.key,e)},expression:"postParams[param.key]"}},t._l(a.value,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1):"file"===a.kind?e("el-upload",{ref:"upload",refInFor:!0,attrs:{action:"/","on-change":t.getUploader(a.key,t.rawFileNames,t.rawFiles),"auto-upload":!1,multiple:!1,"list-type":"text","show-file-list":!1}},[e("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选择文件")]),t.rawFileNames[a.key]?e("div",[t._v(" "+t._s(t.rawFileNames[a.key])+" ")]):t._e()],1):"bool"===a.kind?e("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.postParams[a.key],callback:function(e){t.$set(t.postParams,a.key,e)},expression:"postParams[param.key]"}}):e("el-input",{attrs:{placeholder:"请输入"},model:{value:t.postParams[a.key],callback:function(e){t.$set(t.postParams,a.key,e)},expression:"postParams[param.key]"}})],1)],1)})),e("el-form-item",{attrs:{label:"方案标签："}},[e("el-input",{attrs:{clearable:"",placeholder:"可留空"},model:{value:t.postParams.tag,callback:function(a){t.$set(t.postParams,"tag",a)},expression:"postParams.tag"}})],1),e("el-form-item",{attrs:{label:"加载方案："}},[e("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:"选择标签",size:"small"},model:{value:t.currentTag,callback:function(a){t.currentTag=a},expression:"currentTag"}},t._l(t.knownTags,(function(t){return e("el-option",{key:t.tag,attrs:{label:t.tag,value:t.tag}})})),1),e("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",disabled:null===t.currentTag},on:{click:t.loadParameters}},[t._v("加载")])],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",disabled:!t.canCommitQuery},on:{click:t.performPrediction}},[t._v("预测")])],1)],2)},n=[],l=(e("b0c0"),e("159b"),e("b64b"),e("99af"),e("caad"),e("2532"),e("21c9")),o={name:"SinglePredictSelectForm",components:{YearRangeSelector:l["a"]},data:function(){return{graphDataInternal:[],tableOneDataInternal:[],tableTwoDataInternal:[],requiredParams:[],rawFiles:{},rawFileNames:{},allMethods:[],onlyThosePostParams:{beginYear:null,endYear:null,method:"",tag:null,tagType:this.tagType},postParams:{beginYear:null,endYear:null,method:"",tag:null,tagType:this.tagType},knownTags:[],currentTag:null}},computed:{canCommitQuery:function(){var t=this.$data.postParams;return null!==t.beginYear&&null!==t.endYear}},mounted:function(){this.$data.postParams.method=this.wiredMethod,this.loadTags()},methods:{getUploader:function(t,a,e){var r=this;return function(n){a[t]=n.name,e[t]=n.raw,r._watcher.update()}},loadTags:function(){var t=this;this.$axios.get("/tags/query",{params:{tagType:this.tagType}}).then((function(a){t.$data.knownTags=a.data.data}))},performPrediction:function(){var t=this,a=new FormData;Object.keys(this.$data.postParams).forEach((function(e){a.append(e,t.$data.postParams[e])})),a.append("PreStartYear",this.$data.postParams.beginYear),a.append("PreEndYear",this.$data.postParams.endYear),a.append("StartYear",this.$data.postParams.beginYear),a.append("EndYear",this.$data.postParams.endYear),Object.keys(this.$data.rawFiles).forEach((function(e){a.append(e,t.$data.rawFiles[e])})),this.$axios.post("/predict/region/single",a).then((function(a){t.$data.graphDataInternal=a.data.data.tableTwoData,t.$data.tableOneDataInternal=a.data.data.tableOneData,t.$data.tableTwoDataInternal=a.data.data.tableTwoData,a.data.data.unit&&t.$emit("update:unit",a.data.data.unit)}))},loadParameters:function(){var t=this;this.$axios.get("/params/predict/static/region",{params:{tag:this.$data.currentTag}}).then((function(a){t.$data.postParams=a.data.data}))},generateMultipleChoicePlaceholder:function(t){return t.min_choice&&t.max_choice?t.min_choice===t.max_choice?"请选择 ".concat(t.max_choice," 项"):"请选择 ".concat(t.min_choice," 到 ").concat(t.max_choice," 项"):t.max_choice?"请选择不超过 ".concat(t.max_choice," 项"):t.min_choice?"请选择至少 ".concat(t.min_choice," 项"):"请选择至少 1 项"}},watch:{graphDataInternal:function(t){this.$emit("update:graphData",t)},tableOneDataInternal:function(t){this.$emit("update:tableOneData",t)},tableTwoDataInternal:function(t){this.$emit("update:tableTwoData",t)},"postParams.method":function(t){var a=this,e=Object.keys(this.$data.onlyThosePostParams);Object.keys(this.$data.postParams).forEach((function(t){e.includes(t)||a.$delete(a.postParams,t)})),this.$data.requiredParams=[],this.$axios.get("/get/args",{params:{method:t}}).then((function(t){t.data.data.para.forEach((function(t){"StartYear"===t.key||"EndYear"===t.key||"PreStartYear"===t.key||"PreEndYear"===t.key||(a.$data.requiredParams.push(t),void 0!==t.default&&a.$set(a.postParams,t.key,t.default))}))}))}},props:["graphData","tableOneData","tableTwoData","wiredMethod","tagType","unit"]},i=o,s=(e("9ab5"),e("2877")),c=Object(s["a"])(i,r,n,!1,null,"373bcf06",null);a["a"]=c.exports},"79dd":function(t,a,e){"use strict";var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{directives:[{name:"show",rawName:"v-show",value:0!==t.xData.length,expression:"xData.length !== 0"}],staticStyle:{"margin-left":"20px"}},[e("el-row",[e("div",{staticStyle:{width:"680px",height:"300px"},attrs:{id:t.uniqueId}})]),e("el-row",[e("el-form",[e("el-form-item",[e("el-button",{on:{click:t.exportImage}},[t._v("导出图像")])],1),e("el-form-item",{attrs:{label:"显示方式："}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.currentDisplayMethod,callback:function(a){t.currentDisplayMethod=a},expression:"currentDisplayMethod"}},t._l(t.displayMethods,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1)],1)],1)},n=[],l=(e("1276"),e("ac1f"),e("5cc6"),e("9a8c"),e("a975"),e("735e"),e("c1ac"),e("d139"),e("3a7b"),e("d5d6"),e("82f8"),e("e91f"),e("60bd"),e("5f96"),e("3280"),e("3fcc"),e("ca91"),e("25a1"),e("cd26"),e("3c5d"),e("2954"),e("649e"),e("219c"),e("170b"),e("b39a"),e("72f7"),e("d3b7"),e("159b"),e("b0c0"),e("99af"),e("b680"),e("313e")),o=e("21a6");function i(t){for(var a=t.split(";base64,"),e=a[0].split(":")[1],r=window.atob(a[1]),n=r.length,l=new Uint8Array(n),o=0;o<n;++o)l[o]=r.charCodeAt(o);return new Blob([l],{type:e})}var s={data:function(){return{currentChart:void 0,xName:"",xData:[],yName:"",yData:[],displayMethods:[{label:"折线图",value:"line"},{label:"柱状图",value:"bar"},{label:"散点图",value:"scatter"}],currentDisplayMethod:"line"}},methods:{refreshChart:function(){var t=this;void 0===this.currentChart&&(this.currentChart=l["init"](document.getElementById(this.uniqueId)));var a=[];this.$data.yData.forEach((function(e){a.push({data:e.data,name:e.name,type:t.$data.currentDisplayMethod})}));var e={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(t){for(var a="",e=0;e<t.length;e+=1)if(""!==t[e].seriesName&&void 0!==t[e].value){var r=t[e].color;a+='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background:'.concat(r,'"></span>'),a+="".concat(t[e].seriesName," - ").concat(parseFloat(t[e].value).toFixed(2),"</br>")}return a}},xAxis:{type:"category",name:this.$data.xName,data:this.$data.xData,axisTick:{alignWithLabel:!0},boundaryGap:"bar"===this.$data.currentDisplayMethod,onZero:!0,axisLabel:{show:!0,textStyle:{color:"#ffffff",fontSize:14}},axisLine:{lineStyle:{color:"#ffffff"}}},yAxis:{type:"value",name:this.$data.yName,axisLabel:{show:!0,textStyle:{color:"#ffffff",fontSize:14}},axisLine:{lineStyle:{color:"#ffffff"}}},series:a,legend:{orient:"horizontal",x:"center",y:"top",textStyle:{color:"#ffffff",fontSize:16}}};this.currentChart.setOption(e,!0)},exportImage:function(){if(this.currentChart){var t=this.currentChart.getDataURL(),a=i(t);Object(o["saveAs"])(a,"预测图像.png")}}},watch:{currentDisplayMethod:function(){this.refreshChart()}},computed:{uniqueId:function(){return void 0!==this.uid?this.uid:"globalChart"}},props:["uid"]},c=s,u=e("2877"),d=Object(u["a"])(c,r,n,!1,null,"5625fc01",null);a["a"]=d.exports},"9ab5":function(t,a,e){"use strict";e("18e1")},"9ec8":function(t,a,e){"use strict";var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("el-form",[void 0===t.nomapermse&&0!==t.tableOneData.length?e("el-form-item",{attrs:{label:"评价指标表："}},[e("el-table",{attrs:{data:t.tableOneData}},[e("el-table-column",{attrs:{prop:"name",label:"名称"}}),e("el-table-column",{attrs:{prop:"mape",label:"MAPE（%）"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(a.row.mape.toFixed(2))+" ")]}}],null,!1,3612083124)}),e("el-table-column",{attrs:{prop:"rmse",label:"RMSE"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(a.row.rmse.toFixed(2))+" ")]}}],null,!1,616966500)})],1)],1):t._e(),void 0===t.nomapermse&&0!==t.tableOneData.length?e("el-form-item",[e("el-button",{on:{click:t.exportTableOneSheet}},[t._v("导出评价指标表")])],1):t._e(),0!==t.tableTwoData.length?e("el-form-item",{attrs:{label:"年份 − 预测值表："}},[e("el-table",{attrs:{data:t.tableTwoData}},[e("el-table-column",{attrs:{prop:"year",label:"年份"}}),e("el-table-column",{attrs:{prop:"tag",label:"方案"}}),e("el-table-column",{attrs:{prop:"predict",label:"预测值（MW）"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(a.row.predict.toFixed(0))+" ")]}}],null,!1,4170251218)})],1)],1):t._e(),0!==t.tableTwoData.length?e("el-form-item",[e("el-button",{on:{click:t.exportTableTwoSheet}},[t._v("导出预测结果表")])],1):t._e()],1)},n=[],l=e("f59f"),o=e("21a6"),i={name:"ResultTable",props:["nomapermse"],data:function(){return{tableOneData:[],tableTwoData:[]}},methods:{exportTableSheet:function(t,a){var e=l["parse"](t,{fields:a}),r=new Blob([e],{type:"text/csv"});Object(o["saveAs"])(r,"预测结果表.csv")},exportTableOneSheet:function(){this.exportTableSheet(this.$data.tableOneData,["name","mape","rmse"])},exportTableTwoSheet:function(){this.exportTableSheet(this.$data.tableTwoData,["year","tag","predict"])}}},s=i,c=e("2877"),u=Object(c["a"])(s,r,n,!1,null,"ef61cbe0",null);a["a"]=u.exports},a3e9:function(t,a,e){"use strict";e.r(a);var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("el-row",{attrs:{type:"flex",justify:"center"}},[e("el-col",{attrs:{span:11,offset:1}},[e("MutableForm",{attrs:{"wired-method":"地区组合预测模型","tag-type":"MIX","graph-data":t.graphData,"table-one-data":t.tableOneData,"table-two-data":t.tableTwoData,unit:t.unit},on:{"update:graphData":function(a){t.graphData=a},"update:graph-data":function(a){t.graphData=a},"update:tableOneData":function(a){t.tableOneData=a},"update:table-one-data":function(a){t.tableOneData=a},"update:tableTwoData":function(a){t.tableTwoData=a},"update:table-two-data":function(a){t.tableTwoData=a},"update:unit":function(a){t.unit=a}}})],1),e("el-col",{attrs:{span:12}},[e("el-row",[e("ResultChart",{ref:"resultChart"})],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:22,offset:1}},[e("ResultTable",{ref:"resultTable"})],1)],1)],1)},n=[],l=(e("159b"),e("b0c0"),e("47ef")),o=e("79dd"),i=e("9ec8"),s={name:"PlaceMixPrediction",components:{ResultTable:i["a"],ResultChart:o["a"],MutableForm:l["a"]},data:function(){return{graphData:[],tableOneData:[],tableTwoData:[],unit:""}},watch:{graphData:function(t){console.log(t),this.$refs.resultChart.xName="年份",this.$refs.resultChart.yName="预测值（MW）",this.$refs.resultChart.xData=t.xData,this.$refs.resultChart.yData=t.yData,this.$refs.resultChart.refreshChart()},tableOneData:function(t){this.$refs.resultTable.tableOneData=t},tableTwoData:function(t){for(var a=[],e=function(e){var r=0;t.yData[e].data.forEach((function(n){a.push({year:t.xData[r],tag:t.yData[e].name,predict:n}),r+=1}))},r=0;r<t.yData.length;r+=1)e(r);this.$refs.resultTable.tableTwoData=a},unit:function(t){this.$refs.resultChart.unit=t,this.$refs.resultTable.unit=t}}},c=s,u=e("2877"),d=Object(u["a"])(c,r,n,!1,null,"3989cb2a",null);a["default"]=d.exports},b680:function(t,a,e){"use strict";var r=e("23e7"),n=e("a691"),l=e("408a"),o=e("1148"),i=e("d039"),s=1..toFixed,c=Math.floor,u=function(t,a,e){return 0===a?e:a%2===1?u(t,a-1,e*t):u(t*t,a/2,e)},d=function(t){var a=0,e=t;while(e>=4096)a+=12,e/=4096;while(e>=2)a+=1,e/=2;return a},p=function(t,a,e){var r=-1,n=e;while(++r<6)n+=a*t[r],t[r]=n%1e7,n=c(n/1e7)},m=function(t,a){var e=6,r=0;while(--e>=0)r+=t[e],t[e]=c(r/a),r=r%a*1e7},f=function(t){var a=6,e="";while(--a>=0)if(""!==e||0===a||0!==t[a]){var r=String(t[a]);e=""===e?r:e+o.call("0",7-r.length)+r}return e},h=s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!i((function(){s.call({})}));r({target:"Number",proto:!0,forced:h},{toFixed:function(t){var a,e,r,i,s=l(this),c=n(t),h=[0,0,0,0,0,0],b="",g="0";if(c<0||c>20)throw RangeError("Incorrect fraction digits");if(s!=s)return"NaN";if(s<=-1e21||s>=1e21)return String(s);if(s<0&&(b="-",s=-s),s>1e-21)if(a=d(s*u(2,69,1))-69,e=a<0?s*u(2,-a,1):s/u(2,a,1),e*=4503599627370496,a=52-a,a>0){p(h,0,e),r=c;while(r>=7)p(h,1e7,0),r-=7;p(h,u(10,r,1),0),r=a-1;while(r>=23)m(h,1<<23),r-=23;m(h,1<<r),p(h,1,1),m(h,2),g=f(h)}else p(h,0,e),p(h,1<<-a,0),g=f(h)+o.call("0",c);return c>0?(i=g.length,g=b+(i<=c?"0."+o.call("0",c-i)+g:g.slice(0,i-c)+"."+g.slice(i-c))):g=b+g,g}})}}]);
//# sourceMappingURL=chunk-4cae5839.8ad6042e.js.map