(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-92567e4e"],{1148:function(a,e,t){"use strict";var r=t("a691"),n=t("1d80");a.exports="".repeat||function(a){var e=String(n(this)),t="",l=r(a);if(l<0||l==1/0)throw RangeError("Wrong number of repetitions");for(;l>0;(l>>>=1)&&(e+=e))1&l&&(t+=e);return t}},"3d6c":function(a,e,t){"use strict";t("8d7a")},"408a":function(a,e,t){var r=t("c6b6");a.exports=function(a){if("number"!=typeof a&&"Number"!=r(a))throw TypeError("Incorrect invocation");return+a}},"47ef":function(a,e,t){"use strict";var r=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-form",{attrs:{"label-position":"right","label-width":"auto"}},[t("el-form-item",{attrs:{label:"预测方法："}},[t("el-select",{attrs:{placeholder:"请选择",disabled:null!==a.wiredMethod},model:{value:a.postParams.method,callback:function(e){a.$set(a.postParams,"method",e)},expression:"postParams.method"}},a._l(a.allMethods,(function(a){return t("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1),t("el-form-item",{attrs:{label:"预测年份："}},[t("year-range-selector",{attrs:{"begin-year":a.postParams.beginYear,"end-year":a.postParams.endYear},on:{"update:beginYear":function(e){return a.$set(a.postParams,"beginYear",e)},"update:begin-year":function(e){return a.$set(a.postParams,"beginYear",e)},"update:endYear":function(e){return a.$set(a.postParams,"endYear",e)},"update:end-year":function(e){return a.$set(a.postParams,"endYear",e)}}})],1),a._l(a.requiredParams,(function(e){return t("div",{key:e.key},[t("el-form-item",{attrs:{label:e.label+"："}},["int"===e.kind?t("el-input",{attrs:{step:1,type:"number",min:e.limits.min_value,max:e.limits.max_value,clearable:"",placeholder:"请输入整数数字"},model:{value:a.postParams[e.key],callback:function(t){a.$set(a.postParams,e.key,t)},expression:"postParams[param.key]"}}):"float"===e.kind?t("el-input",{attrs:{step:.01,type:"number",min:e.limits.min_value,max:e.limits.max_value,clearable:"",placeholder:"请输入数字"},model:{value:a.postParams[e.key],callback:function(t){a.$set(a.postParams,e.key,t)},expression:"postParams[param.key]"}}):e.kind.startsWith("option")?t("el-select",{attrs:{placeholder:"请选择一项"},model:{value:a.postParams[e.key],callback:function(t){a.$set(a.postParams,e.key,t)},expression:"postParams[param.key]"}},a._l(e.value,(function(a){return t("el-option",{key:a,attrs:{label:a,value:a}})})),1):e.kind.startsWith("multioption")?t("el-select",{attrs:{multiple:"",placeholder:a.generateMultipleChoicePlaceholder(e.limits),"multiple-limit":e.limits.max_choice},model:{value:a.postParams[e.key],callback:function(t){a.$set(a.postParams,e.key,t)},expression:"postParams[param.key]"}},a._l(e.value,(function(a){return t("el-option",{key:a,attrs:{label:a,value:a}})})),1):"file"===e.kind?t("el-upload",{ref:"upload",refInFor:!0,attrs:{action:"/","on-change":a.getUploader(e.key,a.rawFileNames,a.rawFiles),"auto-upload":!1,multiple:!1,"list-type":"text","show-file-list":!1}},[t("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[a._v("选择文件")]),a.rawFileNames[e.key]?t("div",[a._v(" "+a._s(a.rawFileNames[e.key])+" ")]):a._e()],1):"bool"===e.kind?t("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:a.postParams[e.key],callback:function(t){a.$set(a.postParams,e.key,t)},expression:"postParams[param.key]"}}):t("el-input",{attrs:{placeholder:"请输入"},model:{value:a.postParams[e.key],callback:function(t){a.$set(a.postParams,e.key,t)},expression:"postParams[param.key]"}})],1)],1)})),t("el-form-item",{attrs:{label:"方案标签："}},[t("el-input",{attrs:{clearable:"",placeholder:"可留空"},model:{value:a.postParams.tag,callback:function(e){a.$set(a.postParams,"tag",e)},expression:"postParams.tag"}})],1),t("el-form-item",{attrs:{label:"加载方案："}},[t("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:"选择标签",size:"small"},model:{value:a.currentTag,callback:function(e){a.currentTag=e},expression:"currentTag"}},a._l(a.knownTags,(function(a){return t("el-option",{key:a.tag,attrs:{label:a.tag,value:a.tag}})})),1),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",disabled:null===a.currentTag},on:{click:a.loadParameters}},[a._v("加载")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",disabled:!a.canCommitQuery},on:{click:a.performPrediction}},[a._v("预测")])],1)],2)},n=[],l=(t("b0c0"),t("159b"),t("b64b"),t("99af"),t("caad"),t("2532"),t("21c9")),o={name:"SinglePredictSelectForm",components:{YearRangeSelector:l["a"]},data:function(){return{graphDataInternal:[],tableOneDataInternal:[],tableTwoDataInternal:[],requiredParams:[],rawFiles:{},rawFileNames:{},allMethods:[],onlyThosePostParams:{beginYear:null,endYear:null,method:"",tag:null,tagType:this.tagType},postParams:{beginYear:null,endYear:null,method:"",tag:null,tagType:this.tagType},knownTags:[],currentTag:null}},computed:{canCommitQuery:function(){var a=this.$data.postParams;return null!==a.beginYear&&null!==a.endYear}},mounted:function(){this.$data.postParams.method=this.wiredMethod,this.loadTags()},methods:{getUploader:function(a,e,t){var r=this;return function(n){e[a]=n.name,t[a]=n.raw,r._watcher.update()}},loadTags:function(){var a=this;this.$axios.get("/tags/query",{params:{tagType:this.tagType}}).then((function(e){a.$data.knownTags=e.data.data}))},performPrediction:function(){var a=this,e=new FormData;Object.keys(this.$data.postParams).forEach((function(t){e.append(t,a.$data.postParams[t])})),e.append("PreStartYear",this.$data.postParams.beginYear),e.append("PreEndYear",this.$data.postParams.endYear),e.append("StartYear",this.$data.postParams.beginYear),e.append("EndYear",this.$data.postParams.endYear),Object.keys(this.$data.rawFiles).forEach((function(t){e.append(t,a.$data.rawFiles[t])})),this.$axios.post("/predict/region/single",e).then((function(e){a.$data.graphDataInternal=e.data.data.tableTwoData,a.$data.tableOneDataInternal=e.data.data.tableOneData,a.$data.tableTwoDataInternal=e.data.data.tableTwoData}))},loadParameters:function(){var a=this;this.$axios.get("/params/predict/static/region",{params:{tag:this.$data.currentTag}}).then((function(e){a.$data.postParams=e.data.data}))},generateMultipleChoicePlaceholder:function(a){return a.min_choice&&a.max_choice?a.min_choice===a.max_choice?"请选择 ".concat(a.max_choice," 项"):"请选择 ".concat(a.min_choice," 到 ").concat(a.max_choice," 项"):a.max_choice?"请选择不超过 ".concat(a.max_choice," 项"):a.min_choice?"请选择至少 ".concat(a.min_choice," 项"):"请选择至少 1 项"}},watch:{graphDataInternal:function(a){this.$emit("update:graphData",a)},tableOneDataInternal:function(a){this.$emit("update:tableOneData",a)},tableTwoDataInternal:function(a){this.$emit("update:tableTwoData",a)},"postParams.method":function(a){var e=this,t=Object.keys(this.$data.onlyThosePostParams);Object.keys(this.$data.postParams).forEach((function(a){t.includes(a)||e.$delete(e.postParams,a)})),this.$data.requiredParams=[],this.$axios.get("/get/args",{params:{method:a}}).then((function(a){a.data.data.para.forEach((function(a){"StartYear"===a.key||"EndYear"===a.key||"PreStartYear"===a.key||"PreEndYear"===a.key||(e.$data.requiredParams.push(a),void 0!==a.default&&e.$set(e.postParams,a.key,a.default))}))}))}},props:["graphData","tableOneData","tableTwoData","wiredMethod","tagType"]},s=o,i=(t("3d6c"),t("2877")),c=Object(i["a"])(s,r,n,!1,null,"0cf60430",null);e["a"]=c.exports},"79dd":function(a,e,t){"use strict";var r=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{directives:[{name:"show",rawName:"v-show",value:0!==a.xData.length,expression:"xData.length !== 0"}],staticStyle:{"margin-left":"20px"}},[t("el-row",[t("div",{staticStyle:{width:"680px",height:"300px"},attrs:{id:a.uniqueId}})]),t("el-row",[t("el-form",[t("el-form-item",[t("el-button",{on:{click:a.exportImage}},[a._v("导出图像")])],1),t("el-form-item",{attrs:{label:"显示方式："}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:a.currentDisplayMethod,callback:function(e){a.currentDisplayMethod=e},expression:"currentDisplayMethod"}},a._l(a.displayMethods,(function(a){return t("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1)],1)],1)],1)},n=[],l=(t("1276"),t("ac1f"),t("5cc6"),t("9a8c"),t("a975"),t("735e"),t("c1ac"),t("d139"),t("3a7b"),t("d5d6"),t("82f8"),t("e91f"),t("60bd"),t("5f96"),t("3280"),t("3fcc"),t("ca91"),t("25a1"),t("cd26"),t("3c5d"),t("2954"),t("649e"),t("219c"),t("170b"),t("b39a"),t("72f7"),t("d3b7"),t("159b"),t("b0c0"),t("99af"),t("b680"),t("313e")),o=t("21a6");function s(a){for(var e=a.split(";base64,"),t=e[0].split(":")[1],r=window.atob(e[1]),n=r.length,l=new Uint8Array(n),o=0;o<n;++o)l[o]=r.charCodeAt(o);return new Blob([l],{type:t})}var i={data:function(){return{currentChart:void 0,xName:"",xData:[],yName:"",yData:[],displayMethods:[{label:"折线图",value:"line"},{label:"柱状图",value:"bar"},{label:"散点图",value:"scatter"}],currentDisplayMethod:"line"}},methods:{refreshChart:function(){var a=this;void 0===this.currentChart&&(this.currentChart=l["init"](document.getElementById(this.uniqueId)));var e=[];this.$data.yData.forEach((function(t){e.push({data:t.data,name:t.name,type:a.$data.currentDisplayMethod})}));var t={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(a){for(var e="",t=0;t<a.length;t+=1)if(""!==a[t].seriesName&&void 0!==a[t].value){var r=a[t].color;e+='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background:'.concat(r,'"></span>'),e+="".concat(a[t].seriesName," - ").concat(parseFloat(a[t].value).toFixed(2),"</br>")}return e}},xAxis:{type:"category",name:this.$data.xName,data:this.$data.xData,axisTick:{alignWithLabel:!0},boundaryGap:"bar"===this.$data.currentDisplayMethod,onZero:!0,axisLabel:{show:!0,textStyle:{color:"#ffffff",fontSize:14}},axisLine:{lineStyle:{color:"#ffffff"}}},yAxis:{type:"value",name:this.$data.yName,axisLabel:{show:!0,textStyle:{color:"#ffffff",fontSize:14}},axisLine:{lineStyle:{color:"#ffffff"}}},series:e,legend:{orient:"horizontal",x:"center",y:"top",textStyle:{color:"#ffffff",fontSize:16}}};this.currentChart.setOption(t,!0)},exportImage:function(){if(this.currentChart){var a=this.currentChart.getDataURL(),e=s(a);Object(o["saveAs"])(e,"预测图像.png")}}},watch:{currentDisplayMethod:function(){this.refreshChart()}},computed:{uniqueId:function(){return void 0!==this.uid?this.uid:"globalChart"}},props:["uid"]},c=i,u=t("2877"),d=Object(u["a"])(c,r,n,!1,null,"5625fc01",null);e["a"]=d.exports},"8d7a":function(a,e,t){},"9ec8":function(a,e,t){"use strict";var r=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-form",[void 0===a.nomapermse&&0!==a.tableOneData.length?t("el-form-item",{attrs:{label:"评价指标表："}},[t("el-table",{attrs:{data:a.tableOneData}},[t("el-table-column",{attrs:{prop:"name",label:"名称"}}),t("el-table-column",{attrs:{prop:"mape",label:"MAPE（%）"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v(" "+a._s(e.row.mape.toFixed(2))+" ")]}}],null,!1,3612083124)}),t("el-table-column",{attrs:{prop:"rmse",label:"RMSE"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v(" "+a._s(e.row.rmse.toFixed(2))+" ")]}}],null,!1,616966500)})],1)],1):a._e(),void 0===a.nomapermse&&0!==a.tableOneData.length?t("el-form-item",[t("el-button",{on:{click:a.exportTableOneSheet}},[a._v("导出评价指标表")])],1):a._e(),0!==a.tableTwoData.length?t("el-form-item",{attrs:{label:"年份 − 预测值表："}},[t("el-table",{attrs:{data:a.tableTwoData}},[t("el-table-column",{attrs:{prop:"year",label:"年份"}}),t("el-table-column",{attrs:{prop:"tag",label:"方案"}}),t("el-table-column",{attrs:{prop:"predict",label:"预测值（MW）"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v(" "+a._s(e.row.predict.toFixed(0))+" ")]}}],null,!1,4170251218)})],1)],1):a._e(),0!==a.tableTwoData.length?t("el-form-item",[t("el-button",{on:{click:a.exportTableTwoSheet}},[a._v("导出预测结果表")])],1):a._e()],1)},n=[],l=t("f59f"),o=t("21a6"),s={name:"ResultTable",props:["nomapermse"],data:function(){return{tableOneData:[],tableTwoData:[]}},methods:{exportTableSheet:function(a,e){var t=l["parse"](a,{fields:e}),r=new Blob([t],{type:"text/csv"});Object(o["saveAs"])(r,"预测结果表.csv")},exportTableOneSheet:function(){this.exportTableSheet(this.$data.tableOneData,["name","mape","rmse"])},exportTableTwoSheet:function(){this.exportTableSheet(this.$data.tableTwoData,["year","tag","predict"])}}},i=s,c=t("2877"),u=Object(c["a"])(i,r,n,!1,null,"ef61cbe0",null);e["a"]=u.exports},a3e9:function(a,e,t){"use strict";t.r(e);var r=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",[t("el-row",{attrs:{type:"flex",justify:"center"}},[t("el-col",{attrs:{span:11,offset:1}},[t("MutableForm",{attrs:{"wired-method":"地区组合预测模型","tag-type":"MIX","graph-data":a.graphData,"table-one-data":a.tableOneData,"table-two-data":a.tableTwoData},on:{"update:graphData":function(e){a.graphData=e},"update:graph-data":function(e){a.graphData=e},"update:tableOneData":function(e){a.tableOneData=e},"update:table-one-data":function(e){a.tableOneData=e},"update:tableTwoData":function(e){a.tableTwoData=e},"update:table-two-data":function(e){a.tableTwoData=e}}})],1),t("el-col",{attrs:{span:12}},[t("el-row",[t("ResultChart",{ref:"resultChart"})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:22,offset:1}},[t("ResultTable",{ref:"resultTable"})],1)],1)],1)},n=[],l=(t("159b"),t("b0c0"),t("47ef")),o=t("79dd"),s=t("9ec8"),i={name:"PlaceMixPrediction",components:{ResultTable:s["a"],ResultChart:o["a"],MutableForm:l["a"]},data:function(){return{graphData:[],tableOneData:[],tableTwoData:[]}},watch:{graphData:function(a){console.log(a),this.$refs.resultChart.xName="年份",this.$refs.resultChart.yName="预测值（MW）",this.$refs.resultChart.xData=a.xData,this.$refs.resultChart.yData=a.yData,this.$refs.resultChart.refreshChart()},tableOneData:function(a){this.$refs.resultTable.tableOneData=a},tableTwoData:function(a){for(var e=[],t=function(t){var r=0;a.yData[t].data.forEach((function(n){e.push({year:a.xData[r],tag:a.yData[t].name,predict:n}),r+=1}))},r=0;r<a.yData.length;r+=1)t(r);this.$refs.resultTable.tableTwoData=e}}},c=i,u=t("2877"),d=Object(u["a"])(c,r,n,!1,null,"0d0f983e",null);e["default"]=d.exports},b680:function(a,e,t){"use strict";var r=t("23e7"),n=t("a691"),l=t("408a"),o=t("1148"),s=t("d039"),i=1..toFixed,c=Math.floor,u=function(a,e,t){return 0===e?t:e%2===1?u(a,e-1,t*a):u(a*a,e/2,t)},d=function(a){var e=0,t=a;while(t>=4096)e+=12,t/=4096;while(t>=2)e+=1,t/=2;return e},p=function(a,e,t){var r=-1,n=t;while(++r<6)n+=e*a[r],a[r]=n%1e7,n=c(n/1e7)},m=function(a,e){var t=6,r=0;while(--t>=0)r+=a[t],a[t]=c(r/e),r=r%e*1e7},f=function(a){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==a[e]){var r=String(a[e]);t=""===t?r:t+o.call("0",7-r.length)+r}return t},h=i&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){i.call({})}));r({target:"Number",proto:!0,forced:h},{toFixed:function(a){var e,t,r,s,i=l(this),c=n(a),h=[0,0,0,0,0,0],b="",g="0";if(c<0||c>20)throw RangeError("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return String(i);if(i<0&&(b="-",i=-i),i>1e-21)if(e=d(i*u(2,69,1))-69,t=e<0?i*u(2,-e,1):i/u(2,e,1),t*=4503599627370496,e=52-e,e>0){p(h,0,t),r=c;while(r>=7)p(h,1e7,0),r-=7;p(h,u(10,r,1),0),r=e-1;while(r>=23)m(h,1<<23),r-=23;m(h,1<<r),p(h,1,1),m(h,2),g=f(h)}else p(h,0,t),p(h,1<<-e,0),g=f(h)+o.call("0",c);return c>0?(s=g.length,g=b+(s<=c?"0."+o.call("0",c-s)+g:g.slice(0,s-c)+"."+g.slice(s-c))):g=b+g,g}})}}]);
//# sourceMappingURL=chunk-92567e4e.f593a555.js.map