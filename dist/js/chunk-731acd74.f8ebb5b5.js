(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-731acd74"],{"21c9":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{style:e.mainStyle,attrs:{type:"flex",justify:"left"}},[a("el-col",[a("el-date-picker",{attrs:{type:"year",placeholder:"起始年份"},on:{change:e.beginChange},model:{value:e.beginYearInternal,callback:function(t){e.beginYearInternal=t},expression:"beginYearInternal"}})],1),a("el-col",{staticStyle:{margin:"auto","text-align":"center",color:"lightgray","font-size":"12px"}},[e._v(" 至 ")]),a("el-col",[a("el-date-picker",{attrs:{type:"year",placeholder:"终止年份"},on:{change:e.endChange},model:{value:e.endYearInternal,callback:function(t){e.endYearInternal=t},expression:"endYearInternal"}})],1)],1)},n=[],l={name:"YearRangeSelector",props:["beginYear","endYear","expand"],data:function(){return{beginYearInternal:this.beginYear,endYearInternal:this.endYear}},methods:{beginChange:function(e){null===e?this.$emit("update:beginYear",null):this.$emit("update:beginYear",e.getFullYear())},endChange:function(e){null===e?this.$emit("update:endYear",null):this.$emit("update:endYear",e.getFullYear())}},watch:{beginYearInternal:function(e){null!==e?this.$emit("update:beginYear",e.getFullYear()):this.$emit("update:beginYear",null)},endYearInternal:function(e){null!==e?this.$emit("update:endYear",e.getFullYear()):this.$emit("update:endYear",null)},beginYear:function(e){this.beginYearInternal=null!==e?new Date(e,1,1):null},endYear:function(e){this.endYearInternal=null!==e?new Date(e,1,1):null}},computed:{mainStyle:function(){return this.expand?"":"width: 55%"}}},o=l,i=(a("6e83"),a("2877")),s=Object(i["a"])(o,r,n,!1,null,"7bfa7c13",null);t["a"]=s.exports},3705:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",[a("el-col",{attrs:{span:8}},[a("ProvMuniPredictSelectForm",{attrs:{"table-three-data":e.tableThreeData,"table-four-data":e.tableFourData},on:{"update:tableThreeData":function(t){e.tableThreeData=t},"update:table-three-data":function(t){e.tableThreeData=t},"update:tableFourData":function(t){e.tableFourData=t},"update:table-four-data":function(t){e.tableFourData=t}}})],1),a("el-col",{attrs:{span:15,offset:1}},[a("el-form",[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:void 0!==e.currentChart,expression:"currentChart !== undefined"}]},[a("el-row",[a("div",{staticStyle:{width:"680px",height:"300px"},attrs:{id:"pieChart"}})])],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:void 0!==e.currentChart,expression:"currentChart !== undefined"}]},[a("el-button",{on:{click:e.exportImage}},[e._v("导出图像")])],1),a("el-form-item",{attrs:{label:"预测年份的协调预测结果："}},[a("el-table",{attrs:{data:e.tableFourData}},[a("el-table-column",{attrs:{label:"年份",prop:"year"}}),a("el-table-column",{attrs:{label:"地区",prop:"region"}}),a("el-table-column",{attrs:{label:"协调前预测值",prop:"predictBefore"}}),a("el-table-column",{attrs:{label:"协调后预测值",prop:"predictAfter"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{disabled:0===e.tableFourData.length},on:{click:e.exportResultSheet}},[e._v("导出预测结果表")])],1),a("el-form-item",{attrs:{label:"历史年份协调预测误差校核："}},[a("el-table",{attrs:{data:e.tableThreeData}},[a("el-table-column",{attrs:{label:"年份",prop:"year"}}),a("el-table-column",{attrs:{label:"地区",prop:"region"}}),a("el-table-column",{attrs:{label:"协调前预测值",prop:"predictValueBefore"}}),a("el-table-column",{attrs:{label:"协调前预测误差",prop:"predictErrorBefore"}}),a("el-table-column",{attrs:{label:"协调后预测值",prop:"predictValueAfter"}}),a("el-table-column",{attrs:{label:"协调后预测误差",prop:"predictErrorAfter"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{disabled:0===e.tableThreeData.length},on:{click:e.exportErrorSheet}},[e._v("导出历史误差表")])],1)],1)],1)],1)],1)},n=[],l=(a("1276"),a("ac1f"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("d3b7"),a("159b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{"label-position":"right","label-width":"auto"}},[a("el-form-item",{attrs:{label:"历史年份区间："}},[a("year-range-selector",{attrs:{expand:!0,"begin-year":e.postParams.historyBeginYear,"end-year":e.postParams.historyEndYear},on:{"update:beginYear":function(t){return e.$set(e.postParams,"historyBeginYear",t)},"update:begin-year":function(t){return e.$set(e.postParams,"historyBeginYear",t)},"update:endYear":function(t){return e.$set(e.postParams,"historyEndYear",t)},"update:end-year":function(t){return e.$set(e.postParams,"historyEndYear",t)}}})],1),a("el-form-item",{attrs:{label:"预测年份："}},[a("el-date-picker",{attrs:{type:"year","value-format":"yyyy",placeholder:"请选择"},model:{value:e.postParams.predictYear,callback:function(t){e.$set(e.postParams,"predictYear",t)},expression:"postParams.predictYear"}})],1),a("el-form-item",{attrs:{label:"省级负荷预测方案选择："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.postParams.provPlan,callback:function(t){e.$set(e.postParams,"provPlan",t)},expression:"postParams.provPlan"}},[e._l(e.knownTags,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.id))]),a("span",{staticStyle:{float:"right",color:"#8492a6"}},[e._v(e._s(e.typeName[t.tagType]))])])})),a("el-option",{key:"__byUpload__",attrs:{label:"通过文件上传",value:"__byUpload__"}})],2)],1),"__byUpload__"===e.postParams.provPlan?a("el-form-item",{attrs:{label:"选择文件："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.postParams.provFile,callback:function(t){e.$set(e.postParams,"provFile",t)},expression:"postParams.provFile"}},e._l(e.knownUploadFiles,(function(t){return a("el-option",{key:e.value+t,attrs:{label:t,value:t}})})),1)],1):e._e(),a("el-form-item",[a("el-upload",{attrs:{multiple:"","file-list":e.postParams.fileList,"show-file-list":!1,"auto-upload":!0,"on-success":e.onSuccess,"on-error":e.onFailure,"before-upload":e.beforeUpload,action:e.baseURL+"/predict/munidata/upload"}},[a("el-button",{attrs:{size:"small",disabled:!e.enabledUploadButton}},[e._v("上传文件")])],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",disabled:!e.canCommitQuery},on:{click:e.performPrediction}},[e._v("预测")])],1)],1)}),o=[],i=a("21c9"),s={name:"ProvMuniPredictSelectForm",components:{YearRangeSelector:i["a"]},data:function(){return{enabledUploadButton:!0,postParams:{historyBeginYear:null,historyEndYear:null,predictYear:null,provPlan:"",provFile:""},knownTags:[],knownUploadFiles:[],tableThreeDataInternal:[],tableFourDataInternal:[],typeName:{MINING:"数据挖掘方案",STATIC_REGIONAL:"地区单预测方案",DYNAMIC_INDUSTRIAL:"行业单预测方案",MIX:"组合预测方案",LONGTERM:"远期规划预测方案",BIGUSER:"大用户预测方案",SOKU:"负荷特性预测方案",CLAMP:"负荷特性预测方案",INTERP:"负荷特性预测方案",YEARCONT:"负荷特性预测方案"}}},methods:{loadTags:function(){var e=this;this.$axios.get("/tags/query",{params:{tagType:"PROVINCE"}}).then((function(t){e.$data.knownTags=t.data.data}))},loadMunicipals:function(){var e=this;this.$axios.get("/region/query").then((function(t){var a=t.data.data;e.$data.postParams.muniData={},a.forEach((function(t){e.$set(e.$data.postParams.muniData,t,"")}))}))},loadUploadedFiles:function(){var e=this;this.$axios.get("/predict/munidata/files").then((function(t){e.$data.knownUploadFiles=t.data.data}))},onSuccess:function(){this.$data.enabledUploadButton=!0,this.$messenger.success("上传成功。"),this.loadUploadedFiles()},onFailure:function(){this.$data.enabledUploadButton=!0,this.$messenger.error("上传失败。")},beforeUpload:function(){this.$data.enabledUploadButton=!1},performPrediction:function(){var e=this;this.$axios.post("/predict/provmuni",this.$data.postParams).then((function(t){e.$data.tableThreeDataInternal=t.data.data.tableThreeData,e.$data.tableFourDataInternal=t.data.data.tableFourData}))}},computed:{canCommitQuery:function(){var e=this.$data.postParams;return null!==e.historyBeginYear&&null!==e.historyEndYear&&(null!==e.predictYear&&(0!==e.provPlan.length&&("__byUpload__"!==e.provPlan||0!==e.provFile.length)))},baseURL:function(){return this.$axios.defaults.baseURL}},mounted:function(){this.loadTags(),this.loadMunicipals(),this.loadUploadedFiles()},props:["tableThreeData","tableFourData"],watch:{tableThreeDataInternal:function(e){this.$emit("update:tableThreeData",e)},tableFourDataInternal:function(e){this.$emit("update:tableFourData",e)}}},u=s,c=a("2877"),d=Object(c["a"])(u,l,o,!1,null,"de5d764a",null),p=d.exports,h=a("f59f"),b=a("21a6"),f=a("313e");function m(e){for(var t=e.split(";base64,"),a=t[0].split(":")[1],r=window.atob(t[1]),n=r.length,l=new Uint8Array(n),o=0;o<n;++o)l[o]=r.charCodeAt(o);return new Blob([l],{type:a})}var g={name:"ProvMuniCoordPredict",data:function(){return{currentChart:void 0,tableThreeData:[],tableFourData:[]}},methods:{refreshChart:function(){console.log("called!");var e=this.$data.tableFourData;void 0===this.currentChart&&(this.currentChart=f["init"](document.getElementById("pieChart")));var t=[];e.forEach((function(e){t.push({name:e.region,value:e.predictAfter})})),this.currentChart.setOption({series:[{name:"协调预测结果",type:"pie",radius:"55%",data:t}]},!0)},exportImage:function(){if(this.currentChart){var e=this.currentChart.getDataURL(),t=m(e);Object(b["saveAs"])(t,"chart.png")}},exportTableSheet:function(e,t){var a=h["parse"](e,{fields:t}),r=new Blob([a],{type:"text/csv"});Object(b["saveAs"])(r,"database.csv")},exportErrorSheet:function(){this.exportTableSheet(this.$data.tableThreeData,["year","region","predictValueBefore","predictErrorBefore","predictValueAfter","predictErrorAfter"])},exportResultSheet:function(){this.exportTableSheet(this.$data.tableFourData,["year","region","predictBefore","predictAfter"])}},components:{ProvMuniPredictSelectForm:p},watch:{tableFourData:{handler:function(){this.refreshChart()},deep:!0,immediate:!1}}},v=g,y=Object(c["a"])(v,r,n,!1,null,"cd53e230",null);t["default"]=y.exports},"6e83":function(e,t,a){"use strict";a("e4af")},e4af:function(e,t,a){}}]);
//# sourceMappingURL=chunk-731acd74.f8ebb5b5.js.map