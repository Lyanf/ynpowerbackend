(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48ccaa84"],{"2dfa":function(a,t,e){"use strict";e.r(t);var r=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("el-row",[e("el-col",{staticStyle:{height:"100%"},attrs:{offset:1,span:12}},[e("el-row",[e("el-transfer",{staticStyle:{height:"100%"},attrs:{filterable:"","filter-placeholder":"输入以查找",data:a.knownFactors,titles:["待选择影响因素","已选择影响因素"],"button-texts":["移除","添加"]},model:{value:a.postParams.factors,callback:function(t){a.$set(a.postParams,"factors",t)},expression:"postParams.factors"}})],1),e("el-row",{staticStyle:{"margin-top":"5em"}},[a.miningResults.length>0?e("span",[a._v("挖掘结果")]):a._e()]),e("el-row",{staticStyle:{"margin-top":"2em"}},a._l(a.miningResults,(function(t){return e("el-tag",{key:t,staticStyle:{margin:"5px"}},[a._v(" "+a._s(t)+" ")])})),1)],1),e("el-col",{staticStyle:{"margin-right":"20px"},attrs:{span:9,offset:1}},[e("el-form",{attrs:{"label-position":"right","label-width":"auto"}},[e("el-form-item",{attrs:{label:"数据年份："}},[e("year-range-selector",{attrs:{"begin-year":a.postParams.StartYear,"end-year":a.postParams.EndYear},on:{"update:beginYear":function(t){return a.$set(a.postParams,"StartYear",t)},"update:begin-year":function(t){return a.$set(a.postParams,"StartYear",t)},"update:endYear":function(t){return a.$set(a.postParams,"EndYear",t)},"update:end-year":function(t){return a.$set(a.postParams,"EndYear",t)}}})],1),e("el-form-item",{attrs:{label:"挖掘方法："}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:a.postParams.method,callback:function(t){a.$set(a.postParams,"method",t)},expression:"postParams.method"}},a._l(a.allMethods,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1)],1),a._l(a.requiredParams,(function(t){return e("div",{key:t.key},["econamelist"!==t.key?e("el-form-item",{attrs:{label:t.label+"："}},["int"===t.kind?e("el-input",{attrs:{step:1,type:"number",clearable:"",placeholder:"请输入整数数字"},model:{value:a.postParams[t.key],callback:function(e){a.$set(a.postParams,t.key,e)},expression:"postParams[param.key]"}}):"float"===t.kind?e("el-input",{attrs:{step:.01,type:"number",clearable:"",placeholder:"请输入数字"},model:{value:a.postParams[t.key],callback:function(e){a.$set(a.postParams,t.key,e)},expression:"postParams[param.key]"}}):t.kind.startsWith("option")?e("el-select",{attrs:{placeholder:"请选择一项"},model:{value:a.postParams[t.key],callback:function(e){a.$set(a.postParams,t.key,e)},expression:"postParams[param.key]"}},a._l(t.value,(function(a){return e("el-option",{key:a,attrs:{label:a,value:a}})})),1):t.kind.startsWith("multioption")?e("el-select",{attrs:{multiple:"",placeholder:"请选择数项"},model:{value:a.postParams[t.key],callback:function(e){a.$set(a.postParams,t.key,e)},expression:"postParams[param.key]"}},a._l(t.value,(function(a){return e("el-option",{key:a,attrs:{label:a,value:a}})})),1):e("el-input",{attrs:{placeholder:"请输入"},model:{value:a.postParams[t.key],callback:function(e){a.$set(a.postParams,t.key,e)},expression:"postParams[param.key]"}})],1):a._e()],1)})),e("el-form-item",{attrs:{label:"方案标签："}},[e("el-input",{attrs:{clearable:"",placeholder:"可留空"},model:{value:a.postParams.tag,callback:function(t){a.$set(a.postParams,"tag",t)},expression:"postParams.tag"}})],1),e("el-form-item",{attrs:{label:"加载方案："}},[e("el-select",{staticStyle:{width:"60%"},attrs:{placeholder:"选择标签",size:"small"},model:{value:a.currentTag,callback:function(t){a.currentTag=t},expression:"currentTag"}},a._l(a.knownTags,(function(a){return e("el-option",{key:a.tag,attrs:{label:a.tag,value:a.tag}})})),1),e("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",disabled:null===a.currentTag},on:{click:a.loadParameters}},[a._v("加载")])],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",disabled:!a.isFormComplete},on:{click:a.commitMining}},[a._v(" 确定 ")]),e("el-button",{on:{click:a.goToResultPage}},[a._v("挖掘结果展示")])],1)],2)],1),e("el-col",{attrs:{offset:1,span:22}},[e("el-form",["K均值算法"===a.postParams.method?e("div",[e("el-form-item",[e("el-button",{attrs:{disabled:0===a.kMeansData.length},on:{click:a.exportKMeansData}},[a._v("导出表格")])],1),e("el-form-item",{attrs:{label:"挖掘结果表："}},[e("el-table",{attrs:{data:a.kMeansData}},[e("el-table-column",{attrs:{prop:"index",label:"类别序号"}}),e("el-table-column",{attrs:{prop:"members",label:"成员"}})],1)],1)],1):a._e(),"主成分分析算法"===a.postParams.method?e("div",[e("el-form-item",[e("el-button",{attrs:{disabled:0===a.pcaData.length},on:{click:a.exportPCAData}},[a._v("导出表格")])],1),e("el-form-item",{attrs:{label:"挖掘结果表："}},[e("el-table",{attrs:{data:a.pcaData}},[e("el-table-column",{attrs:{prop:"index",label:"主成分编号"}}),e("el-table-column",{attrs:{prop:"percentage",label:"所占比例"}}),e("el-table-column",{attrs:{prop:"name",label:"影响因素名称"}}),e("el-table-column",{attrs:{prop:"factor",label:"影响因素对应系数"}})],1)],1)],1):a._e(),"关联规则分析算法"===a.postParams.method?e("div",[e("el-form-item",[e("el-button",{attrs:{disabled:0===a.aprioriData.length},on:{click:a.exportAprioriData}},[a._v("导出表格")])],1),e("el-form-item",{attrs:{label:"挖掘结果表："}},[e("el-table",{attrs:{data:a.aprioriData}},[e("el-table-column",{attrs:{prop:"name",label:"影响因素名称"}}),e("el-table-column",{attrs:{prop:"score",label:"影响因素强弱得分"}}),e("el-table-column",{attrs:{prop:"confidence",label:"置信度"}})],1)],1)],1):a._e()])],1)],1)},s=[],l=(e("159b"),e("a15b"),e("21c9")),o=e("f59f"),n=e("21a6"),i={name:"DataMining",components:{YearRangeSelector:l["a"]},mounted:function(){this.loadFactors(),this.loadTags()},computed:{isFormComplete:function(){var a=this.$data.postParams;return null!==a.StartYear&&null!==a.EndYear&&(0!==a.factors.length&&0!==a.method.length)}},methods:{loadTags:function(){var a=this;this.$axios.get("/tags/query",{params:{tagType:"MINING"}}).then((function(t){a.$data.knownTags=t.data.data}))},loadParameters:function(){var a=this;this.$axios.get("/params/mining",{params:{tag:this.$data.currentTag}}).then((function(t){a.$data.postParams=t.data.data}))},loadFactors:function(){var a=this;this.$axios.get("/factor/query").then((function(t){t.data.data.forEach((function(t){a.$data.knownFactors.push({label:t,key:t})}))}))},commitMining:function(){var a=this,t=this.$data.postParams;t.econamelist=this.$data.postParams.factors,this.$axios.post("/mining/request",t).then((function(e){if(a.$messenger.success("数据挖掘成功。"),"K均值算法"===t.method){a.$data.kMeansData=[];var r=1;e.data.data.Clusters.forEach((function(t){a.$data.kMeansData.push({index:r,members:t.join("、")}),r+=1}))}else if("主成分分析算法"===t.method){a.$data.pcaData=[];for(var s=0;s<e.data.data.N_components.length;s+=1)for(var l=0;l<e.data.data.FactorName.length;l+=1)a.$data.pcaData.push({index:s+1,percentage:e.data.data.ComponetRatio[s],name:e.data.data.FactorName[l],factor:e.data.data.Vectors[s][l]})}else if("关联规则分析算法"===t.method){a.$data.aprioriData=[];for(var o=0;o<e.data.data.FactorsName.length;o+=1)a.$data.aprioriData.push({name:e.data.data.FactorsName[o],score:e.data.data.Score[o],confidence:e.data.data.Confidence[o]})}}))},goToResultPage:function(){window.location="/#/miningResult"},exportKMeansData:function(){this.exportTableSheet(this.$data.kMeansData,["index","members"])},exportPCAData:function(){this.exportTableSheet(this.$data.pcaData,["index","percentage","name","factor"])},exportAprioriData:function(){this.exportTableSheet(this.$data.aprioriData,["name","score","confidence"])},exportTableSheet:function(a,t){var e=o["parse"](a,{fields:t}),r=new Blob([e],{type:"text/csv"});Object(n["saveAs"])(r,"数据挖掘表.csv")}},data:function(){return{allMethods:[{label:"K均值算法",value:"K均值算法"},{label:"主成分分析算法",value:"主成分分析算法"},{label:"关联规则分析算法",value:"关联规则分析算法"}],knownFactors:[],knownTags:[],requiredParams:[],currentTag:null,suggestCategoryCount:null,miningResults:[],postParams:{method:"",factors:[],StartYear:null,EndYear:null,tag:"",tagType:"MINING"},kMeansData:[],pcaData:[],aprioriData:[]}},watch:{"postParams.method":function(a){var t=this;this.$data.requiredParams=[],this.$axios.get("/get/args",{params:{method:a}}).then((function(a){a.data.data.para.forEach((function(a){"StartYear"===a.key||"EndYear"===a.key||"PreStartYear"===a.key||"PreEndYear"===a.key||(t.$data.requiredParams.push(a),void 0!==a.default&&t.$set(t.postParams,a.key,a.default))}))}))}}},c=i,m=(e("9963"),e("2877")),p=Object(m["a"])(c,r,s,!1,null,"3517b468",null);t["default"]=p.exports},9963:function(a,t,e){"use strict";e("f96b")},f96b:function(a,t,e){}}]);
//# sourceMappingURL=chunk-48ccaa84.6baf5892.js.map